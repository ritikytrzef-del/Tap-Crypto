<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Instant Tap Reward</title>

<script src="https://telegram.org/js/telegram-web-app.js?56"></script>
<script type="text/javascript" src="https://cdn.tgads.space/assets/js/adexium-widget.min.js"></script>
<script type="text/javascript">
  let adexiumWidget;
  document.addEventListener('DOMContentLoaded', () => {
    adexiumWidget = new AdexiumWidget({
      wid: '46231eef-4c57-40c2-8f58-fdcdc4d0535b',
      adFormat: 'interstitial',
      firstAdImpressionIntervalInSeconds: 15,
      adImpressionIntervalInSeconds: 60,
      debug: false
    });
    adexiumWidget.autoMode();
  });
</script>
<script src="https://ad.gigapub.tech/script?id=4819"></script>

<style>
  body{margin:0;padding:0;background:#000;font-family:'Segoe UI',sans-serif;color:#fff;overflow:hidden;
       background: radial-gradient(circle at center, #0a0028 0%, #000 80%)}

  #top{position:fixed;top:0;left:0;right:0;background:rgba(0,0,0,0.9);padding:18px 20px;display:flex;
       justify-content:space-between;align-items:center;z-index:999;backdrop-filter: blur(15px);
       border-bottom:4px solid #0ff;box-shadow:0 0 50px #0ff}

  #name{color:#0ff;font-weight:bold;font-size:22px;text-shadow:0 0 25px #0ff}
  #pointBox{background:linear-gradient(135deg,#00ffff,#8a2be2);color:#000;padding:16px 40px;
            border-radius:60px;font-weight:bold;font-size:22px;box-shadow:0 0 80px #0ff;
            border:5px solid #0ff}
  #walletBtn{background:linear-gradient(135deg,#ff00ff,#8a2be2);color:white;padding:16px 40px;
             border-radius:60px;font-weight:bold;cursor:pointer;border:5px solid #f0f;
             box-shadow:0 0 80px #f0f;text-shadow:0 0 20px #fff;font-size:20px}

  #energyBar{width:88%;max-width:420px;height:42px;background:#111;border-radius:22px;margin:30px auto;
             overflow:hidden;border:5px solid #0ff;box-shadow:0 0 60px #0ff, inset 0 0 35px #0ff}
  #energyFill{height:100%;background:linear-gradient(90deg,#ff00ff,#00ffff);transition:0.6s;
               box-shadow:0 0 50px #0ff}
  #energyText{text-align:center;font-weight:bold;color:#0ff;font-size:24px;text-shadow:0 0 30px #0ff;margin:18px 0}

  #adBtn{background:linear-gradient(135deg,#ff00ff,#00ffff);color:#000;padding:28px 40px;border-radius:70px;
         font-weight:bold;margin:60px auto;display:block;width:88%;max-width:460px;font-size:30px;
         box-shadow:0 0 100px #f0f, 0 0 150px #0ff;border:6px solid #0ff;cursor:pointer;
         animation:neonPulse 1.6s infinite}
  @keyframes neonPulse{0%,100%{box-shadow:0 0 100px #f0f,0 0 150px #0ff}50%{box-shadow:0 0 140px #f0f,0 0 200px #0ff}}

  #startScreen{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:1000;
               display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}
  #startScreen h1{font-size:78px;background:linear-gradient(135deg,#00ffff,#ff00ff);
                  -webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:900;
                  text-shadow:0 0 70px #0ff, 0 0 140px #f0f}
  #startScreen p{font-size:30px;color:#0ff;text-shadow:0 0 35px #0ff;margin:50px 0}
  #startBtn{background:linear-gradient(135deg,#ff00ff,#00ffff);color:#000;padding:30px 120px;border-radius:80px;
            font-size:36px;font-weight:bold;border:7px solid #0ff;box-shadow:0 0 100px #0ff, 0 0 160px #f0f;cursor:pointer}

  .screen{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:999;
          display:none;overflow-y:auto;padding:80px 20px 30px;box-sizing:border-box;
          background: radial-gradient(circle at top, #0a0028 0%, #000 80%)}
  .close{position:absolute;top:15px;right:15px;background:#111;width:65px;height:65px;border-radius:50%;
         border:6px solid #0ff;color:#0ff;font-size:44px;cursor:pointer;z-index:1000;
         box-shadow:0 0 70px #0ff}

  .tab-container{display:flex;justify-content:center;gap:25px;margin:40px 0 30px;flex-wrap:wrap}
  .tab-btn{padding:18px 48px;background:#111;border:6px solid #0ff;border-radius:70px;font-weight:bold;
           color:#0ff;cursor:pointer;font-size:20px;transition:0.4s;box-shadow:0 0 60px #0ff;
           text-shadow:0 0 30px #0ff}
  .tab-btn.active{background:linear-gradient(135deg,#00ffff,#8a2be2);color:#000;border:none;
                  box-shadow:0 0 100px #0ff, 0 0 160px #0ff}

  /* Google Play Cards - Screenshot jaisa */
  .voucher-grid{display:grid;grid-template-columns:1fr 1fr;gap:25px;padding:0 10px;justify-items:center}
  .voucher{background:#111;border-radius:40px;overflow:hidden;border:6px solid #0ff;text-align:center;
           box-shadow:0 25px 100px rgba(0,255,255,0.6), 0 0 120px #0ff;position:relative;transition:0.4s;
           max-width:380px}
  .voucher::before{content:"";position:absolute;top:0;left:0;right:0;height:100px;
                    background:linear-gradient(135deg,#8a2be2,#00ffff);border-radius:40px 40px 0 0;
                    box-shadow:0 0 80px #0ff}
  .v-header{position:relative;padding:25px 15px;z-index:2;display:flex;flex-direction:column;align-items:center;gap:10px}
  .v-header img{height:50px;border-radius:15px}
  .v-header span{color:#fff;font-weight:bold;font-size:22px;text-shadow:0 0 25px #000}
  .v-amount{font-size:110px !important;color:#0ff !important;margin:40px 0 15px !important;
             text-shadow:0 0 80px #0ff, 0 0 140px #00ffff !important;font-weight:900 !important;
             letter-spacing:4px}
  .progress{height:16px;background:#000;border-radius:12px;overflow:hidden;margin:25px 40px;
             border:4px solid #0ff;box-shadow:0 0 50px #0ff}
  .progress-fill{height:100%;background:linear-gradient(90deg,#ff00ff,#00ffff);box-shadow:0 0 50px #0ff}
  .progress-text{color:#0ff;font-size:22px !important;margin-bottom:25px !important;
                  font-weight:bold;text-shadow:0 0 30px #0ff}
  .redeem-btn{background:#333;color:#888;padding:20px;border-radius:28px;width:80%;margin:0 auto 30px;
              font-weight:bold;font-size:22px;cursor:not-allowed;border:4px solid #666}
  .redeem-btn.active{background:linear-gradient(135deg,#00ff88,#00ffff);color:#000;cursor:pointer;
                     box-shadow:0 0 90px #0f0;border:none}

  /* TON Card - Same style as Google Play */
  #tonCard{background:#111;border-radius:40px;overflow:hidden;border:6px solid #0ff;text-align:center;
           box-shadow:0 25px 100px rgba(0,255,255,0.6), 0 0 120px #0ff;position:relative;transition:0.4s;
           max-width:380px;margin:30px auto}
  #tonCard::before{content:"";position:absolute;top:0;left:0;right:0;height:100px;
                    background:linear-gradient(135deg,#8a2be2,#00ffff);border-radius:40px 40px 0 0;
                    box-shadow:0 0 80px #0ff}
  #tonCard .v-header{position:relative;padding:25px 15px;z-index:2;display:flex;flex-direction:column;align-items:center;gap:10px}
  #tonCard .v-header img{height:50px}
  #tonCard .v-header span{color:#fff;font-weight:bold;font-size:22px;text-shadow:0 0 25px #000}
  #tonCard .amount{font-size:110px;color:#0ff;margin:40px 0 15px;
                   text-shadow:0 0 80px #0ff, 0 0 140px #00ffff;font-weight:900;letter-spacing:4px}
  #tonCard input{width:88%;padding:22px;background:#000;border:4px solid #0ff;border-radius:20px;
                 color:#0ff;font-size:18px;margin:20px auto;display:block;outline:none}
  #tonWithdrawBtn{padding:20px;border-radius:28px;width:80%;margin:0 auto 30px;
                  font-weight:bold;font-size:22px;cursor:not-allowed;background:#333;border:4px solid #666}
  #tonWithdrawBtn.active{background:linear-gradient(135deg,#00ff88,#00ffff);color:#000;cursor:pointer;
                         box-shadow:0 0 90px #0f0;border:none}

  .history-item{background:#111;padding:30px;margin:25px;border-radius:30px;border-left:12px solid #0ff;
                box-shadow:0 0 60px rgba(0,255,255,0.5)}
  .history-item.success{border-left-color:#0f0;background:#001a08;box-shadow:0 0 70px #0f0}
  .timer{font-size:24px;color:#ff00ff;font-weight:bold;text-shadow:0 0 30px #f0f;margin-top:15px}
  .success-text{color:#00ff88;font-weight:bold;font-size:24px;text-shadow:0 0 30px #0f0}
</style>
</head>
<body>

<div id="top">
  <div id="name">Guest</div>
  <div id="pointBox">Points: <span id="point">0</span></div>
  <button id="walletBtn" onclick="openWallet()">Wallet</button>
</div>

<div id="startScreen">
  <h1>Instant Tap Reward</h1>
  <p>Watch Ads & Earn Rewards!</p>
  <button id="startBtn" onclick="startGame()">START NOW</button>
</div>

<div id="gameArea" style="display:none;text-align:center;padding-top:120px">
  <div style="font-size:100px;margin-bottom:25px;text-shadow:0 0 80px #0ff">Play Video</div>
  <div style="font-size:32px;color:#0ff;margin:35px 0;text-shadow:0 0 40px #0ff">Watch ads = +1 Point each</div>
  
  <div id="energyBar"><div id="energyFill"></div></div>
  <div id="energyText">Daily Ads: <span id="dailyCount">0</span>/320</div>
  
  <button id="adBtn" onclick="watchAd()">Watch Ad = +1 Point</button>
</div>

<!-- Wallet Screen -->
<div id="walletScreen" class="screen">
  <button class="close" onclick="closeScreen()">X</button>
  <h2 style="text-align:center;color:#0ff;margin:35px 0;font-size:46px;text-shadow:0 0 60px #0ff">
    Points: <span id="wPoint">0</span>
  </h2>

  <div class="tab-container">
    <button class="tab-btn" onclick="showTab('google')">Google Play</button>
    <button class="tab-btn active" onclick="showTab('ton')">TON Wallet</button>
    <button class="tab-btn" onclick="showTab('history')">History</button>
  </div>

  <div id="googleTab">
    <div class="voucher-grid" id="vouchers"></div>
  </div>

  <div id="tonTab">
    <div id="tonCard">
      <div class="v-header">
        <img src="https://ton.org/download/ton_symbol.png" alt="TON">
        <span>TON Withdrawal</span>
      </div>
      <div class="amount">$0.1</div>
      <div class="progress"><div class="progress-fill" id="tonProgress" style="width:0%"></div></div>
      <div class="progress-text"><span id="tonCurrent">0</span>/320 Points</div>
      <input type="text" id="tonAddr" placeholder="Enter Your TON Address (UQ... or EQ...)">
      <button id="tonWithdraw" onclick="withdrawTON()">Locked</button>
    </div>
  </div>

  <div id="historyTab" style="display:none">
    <h3 style="text-align:center;color:#0ff;margin:40px 0;font-size:32px;text-shadow:0 0 40px #0ff">Withdrawal History</h3>
    <div id="historyList"><p style="text-align:center;color:#666">No history yet</p></div>
  </div>
</div>

<!-- Redeem Modal for Google Play -->
<div class="modal" id="redeemModal" style="display:none">
  <div style="background:#111;padding:40px;border-radius:40px;width:90%;max-width:420px;margin:100px auto;
              border:6px solid #0ff;box-shadow:0 0 100px #0ff">
    <h2 style="color:#0ff;text-align:center;font-size:32px;text-shadow:0 0 40px #0ff">Redeem Gift Card</h2>
    <input type="text" id="redeemName" placeholder="Your Full Name" style="width:100%;padding:20px;margin:20px 0;background:#000;border:4px solid #0ff;border-radius:20px;color:#0ff;font-size:18px">
    <input type="text" id="redeemEmail" placeholder="Your Gmail Address" style="width:100%;padding:20px;margin:20px 0;background:#000;border:4px solid #0ff;border-radius:20px;color:#0ff;font-size:18px">
    <button onclick="submitRedeem()" style="background:linear-gradient(135deg,#00ff88,#00ffff);color:#000;padding:20px;border-radius:20px;width:100%;font-weight:bold;font-size:22px;
            box-shadow:0 0 70px #0f0;border:none;cursor:pointer">Submit Request</button>
    <button onclick="closeModal()" style="background:#333;color:#888;padding:20px;border-radius:20px;width:100%;margin-top:15px;font-weight:bold;font-size:20px">Cancel</button>
  </div>
</div>

<script>
Telegram.WebApp.ready(); Telegram.WebApp.expand();

const BOT_TOKEN = "8510745729:AAHIr4lQiAeWoxBLq7QA7PyHcG3jaBZDcZQ";
const CHANNEL_ID = "@Instanttapreward";

const user = Telegram.WebApp.initDataUnsafe.user || {};
const userId = user.id ? user.id.toString() : "guest"+Date.now();
const userName = user.first_name || user.username || "Guest";
document.getElementById("name").textContent = userName;

const POINT_KEY = "point_"+userId;
const DAILY_KEY = "daily_ads_"+userId;
const DATE_KEY = "daily_date_"+userId;
const HISTORY_KEY = "history_"+userId;

let points = parseInt(localStorage.getItem(POINT_KEY)) || 0;
let todayAds = 0;
let selectedINR = 0;
const DAILY_LIMIT = 320;

const today = new Date().toISOString().split('T')[0];
if (localStorage.getItem(DATE_KEY) !== today) {
  todayAds = 0; localStorage.setItem(DAILY_KEY, "0"); localStorage.setItem(DATE_KEY, today);
} else {
  todayAds = parseInt(localStorage.getItem(DAILY_KEY)) || 0;
}

const vouchers = [
  {inr:10, points:320}, {inr:20, points:640},
  {inr:50, points:1600}, {inr:100, points:3200}
];

async function watchAd() {
  if (todayAds >= DAILY_LIMIT) { Telegram.WebApp.showAlert("Daily limit reached! Come back tomorrow"); return; }
  const btn = document.getElementById("adBtn"); btn.disabled = true; btn.textContent = "Loading Ad...";
  try {
    await window.showGiga();
    points += 1; todayAds += 1;
    localStorage.setItem(POINT_KEY, points); localStorage.setItem(DAILY_KEY, todayAds);
    Telegram.WebApp.HapticFeedback.notificationOccurred("success");
    update();
  } catch (e) { Telegram.WebApp.showAlert("Ad skipped. Try again!"); }
  finally { btn.disabled = false; btn.textContent = "Watch Ad = +1 Point"; }
}

function update() {
  document.getElementById("point").innerText = points.toLocaleString();
  if (document.getElementById("wPoint")) document.getElementById("wPoint").innerText = points.toLocaleString();
  document.getElementById("dailyCount").innerText = todayAds;
  document.getElementById("energyFill").style.width = (todayAds / DAILY_LIMIT) * 100 + "%";

  const prog = Math.min((points / 320) * 100, 100);
  document.getElementById("tonProgress").style.width = prog + "%";
  document.getElementById("tonCurrent").innerText = points;
  const btn = document.getElementById("tonWithdrawBtn");
  if (points >= 320) {
    btn.classList.add("active"); btn.textContent = "Withdraw $0.1 TON";
  } else {
    btn.classList.remove("active"); btn.textContent = "Locked";
  }

  loadVouchers(); updateHistory();
}

function loadVouchers() {
  let html = "";
  vouchers.forEach(v => {
    const p = Math.min((points / v.points)*100, 100);
    const ok = points >= v.points;
    html += `<div class="voucher">
      <div class="v-header">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Google_Play_Store_badge_EN.svg/1024px-Google_Play_Store_badge_EN.svg.png" alt="Play">
        <span>₹${v.inr} Gift Card</span>
      </div>
      <div class="v-amount">₹${v.inr}</div>
      <div class="progress"><div class="progress-fill" style="width:${p}%"></div></div>
      <div class="progress-text">${points}/${v.points} pts</div>
      <button class="redeem-btn ${ok?'active':''}" ${ok?`onclick="openRedeem(${v.inr})"`:''}>
        ${ok?'Redeem Now':'Locked'}
      </button>
    </div>`;
  });
  document.getElementById("vouchers").innerHTML = html;
}

function openRedeem(inr) { selectedINR = inr; document.getElementById("redeemModal").style.display = "flex"; }
function closeModal() { document.getElementById("redeemModal").style.display = "none"; }

function submitRedeem() {
  const name = document.getElementById("redeemName").value.trim();
  const email = document.getElementById("redeemEmail").value.trim();
  if (!name || !email.includes("@gmail.com")) return Telegram.WebApp.showAlert("Enter valid Name & Gmail!");
  const cost = selectedINR === 10 ? 320 : selectedINR === 20 ? 640 : selectedINR === 50 ? 1600 : 3200;
  if (points < cost) return Telegram.WebApp.showAlert("Not enough points!");
  points -= cost; localStorage.setItem(POINT_KEY, points);
  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({chat_id:CHANNEL_ID,text:`NEW ₹${selectedINR} GOOGLE PLAY\nUser: ${userName} (${userId})\nName: ${name}\nEmail: ${email}`,parse_mode:"HTML"})});
  addToHistory(`Google Play ₹${selectedINR}`, `${name} | ${email}`);
  closeModal(); Telegram.WebApp.showAlert("Request sent! Code in 7 days"); update();
}

function addToHistory(type, details) {
  let h = JSON.parse(localStorage.getItem(HISTORY_KEY) || "[]");
  h.unshift({type, details, time: Date.now(), status: "pending"});
  localStorage.setItem(HISTORY_KEY, JSON.stringify(h));
}

function formatCountdown(seconds) {
  const days = Math.floor(seconds / 86400);
  const hours = Math.floor((seconds % 86400) / 3600);
  const mins = Math.floor((seconds % 3600) / 60);
  return `${days}d ${hours}h ${mins}m left`;
}

function updateHistory() {
  let h = JSON.parse(localStorage.getItem(HISTORY_KEY) || "[]");
  const now = Date.now();
  const sevenDays = 7 * 24 * 60 * 60 * 1000;
  let html = "";
  h.forEach(item => {
    const elapsed = now - item.time;
    const remaining = Math.max(0, sevenDays - elapsed);
    const t = new Date(item.time).toLocaleString();
    if (elapsed >= sevenDays) {
      html += `<div class="history-item success"><b>${item.type}</b><br>${item.details}<br><small>${t}</small><br><div class="success-text">Completed</div></div>`;
    } else {
      html += `<div class="history-item"><b>${item.type}</b><br>${item.details}<br><small>${t}</small><br><div class="timer">${formatCountdown(remaining / 1000)}</div></div>`;
    }
  });
  document.getElementById("historyList").innerHTML = html || "<p style='text-align:center;color:#666'>No history yet</p>";
}

function withdrawTON() {
  if (points < 320) return Telegram.WebApp.showAlert("You need 320 points!");
  const addr = document.getElementById("tonAddr").value.trim();
  if (!addr || (!addr.startsWith("UQ") && !addr.startsWith("EQ"))) return Telegram.WebApp.showAlert("Enter valid TON address!");
  points -= 320; localStorage.setItem(POINT_KEY, points);
  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({chat_id:CHANNEL_ID,text:`NEW $0.1 TON REQUEST\nUser: ${userName} (${userId})\nAddress: <code>${addr}</code>`,parse_mode:"HTML"})});
  addToHistory("TON $0.1", addr);
  Telegram.WebApp.showAlert("Request successful! Payment within 7 days");
  document.getElementById("tonAddr").value = "";
  update();
}

function startGame() { document.getElementById("startScreen").style.display="none"; document.getElementById("gameArea").style.display="block"; update(); }
function openWallet() { closeScreen(); document.getElementById("walletScreen").style.display="block"; update(); }
function closeScreen() { document.querySelectorAll(".screen,.modal").forEach(el=>el.style.display="none"); }

function showTab(tab) {
  document.getElementById("googleTab").style.display = tab==="google"?"block":"none";
  document.getElementById("tonTab").style.display = tab==="ton"?"block":"none";
  document.getElementById("historyTab").style.display = tab==="history"?"block":"none";
  document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
}

setInterval(updateHistory, 60000); // Update countdown every minute
update();
</script>
</body>
</html>
