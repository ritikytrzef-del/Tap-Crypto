<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Spin & Earn</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://sad.adsgram.ai/js/sad.min.js"></script>

<style>
  body{margin:0;padding:0;background:#000;font-family:'Segoe UI',sans-serif;color:#fff;overflow:hidden}
  #top{position:fixed;top:0;left:0;right:0;background:#000;padding:15px;display:flex;justify-content:space-between;align-items:center;z-index:999;box-shadow:0 4px 20px rgba(0,255,255,0.2)}
  #name{color:#0ff;font-weight:bold;font-size:18px}
  #pointBox{background:linear-gradient(135deg,#00ffff,#8a2be2);color:#000;padding:10px 25px;border-radius:30px;font-weight:bold;font-size:17px;box-shadow:0 0 25px #0ff}

  #spinArea{width:320px;height:320px;margin:100px auto 30px;position:relative;
    background:radial-gradient(circle,#00e0ff,#0066ff,#000);
    border-radius:50%;cursor:pointer;overflow:hidden;
    box-shadow:0 0 80px #00ffff,0 0 140px #8a2be2;
    border:10px solid #00ffff;display:flex;flex-direction:column;align-items:center;justify-content:center;
    animation:glow 3s infinite alternate}
  @keyframes glow{from{box-shadow:0 0 80px #00ffff,0 0 140px #8a2be2}to{box-shadow:0 0 110px #00ffff,0 0 200px #8a2be2}}

  .spin-text{color:#fff;font-size:48px;font-weight:900;letter-spacing:3px;text-shadow:0 0 30px #00ffff}
  .sub-text{color:#fff;font-size:28px;font-weight:900;margin-top:-10px;text-shadow:0 0 25px #8a2be2}

  #timerText{font-size:32px;color:#ff00ff;font-weight:bold;margin-top:20px;text-align:center;display:none}

  #pointsDisplay{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);font-size:24px;color:#00ffff;font-weight:bold}

  .plus{position:absolute;font-size:60px;color:#00ffff;font-weight:900;pointer-events:none;
    animation:fly 1.2s forwards;text-shadow:0 0 25px #8a2be2}
  @keyframes fly{to{transform:translateY(-250px) scale(0.3);opacity:0}}

  #float{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}
</style>
</head>
<body>

<div id="top">
  <div id="name">Guest</div>
  <div id="pointBox">Points: <span id="point">0</span></div>
</div>

<div id="spinArea" onclick="spin()">
  <div class="spin-text">SPIN TO</div>
  <div class="sub-text">EARN</div>
  <div id="timerText">Next in: 10s</div>
  <div id="pointsDisplay">Total Points: <span id="totalPoints">0</span></div>
  <div id="float"></div>
</div>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

let AdController = null;
window.addEventListener("load", () => {
  if (window.Adsgram) {
    AdController = window.Adsgram.init({
      blockId: "19122",  // <-- अपना AdsGram Block ID यहाँ डालें
      debug: false     // production में false रखें
    });
  }
});

const user = Telegram.WebApp.initDataUnsafe.user || {};
const userId = user.id ? user.id.toString() : "guest"+Date.now();
const userName = user.first_name || user.username || "Guest";
document.getElementById("name").textContent = userName;

const POINT_KEY = "points_"+userId;

let points = parseInt(localStorage.getItem(POINT_KEY)) || 0;
let isCooldown = false;
let cooldownTime = 0;

function updatePoints() {
  points = parseInt(localStorage.getItem(POINT_KEY)) || 0;
  document.getElementById("point").innerText = points.toLocaleString();
  document.getElementById("totalPoints").innerText = points.toLocaleString();
}

function startCooldown() {
  isCooldown = true;
  cooldownTime = 10; // 10 seconds
  document.getElementById("timerText").style.display = "block";
  document.getElementById("timerText").innerText = `Next in: ${cooldownTime}s`;

  const timerInterval = setInterval(() => {
    cooldownTime--;
    if (cooldownTime <= 0) {
      clearInterval(timerInterval);
      isCooldown = false;
      document.getElementById("timerText").style.display = "none";
    } else {
      document.getElementById("timerText").innerText = `Next in: ${cooldownTime}s`;
    }
  }, 1000);
}

function showPlusOne(e) {
  const p = document.createElement("div");
  p.className = "plus";
  p.innerText = "+1";
  p.style.left = (e.clientX || e.touches[0].clientX) + "px";
  p.style.top = (e.clientY || e.touches[0].clientY) + "px";
  document.getElementById("float").appendChild(p);
  setTimeout(() => p.remove(), 1200);
}

function spin(e) {
  if (isCooldown) {
    Telegram.WebApp.HapticFeedback.notificationOccurred("error");
    Telegram.WebApp.showAlert("Timer chal raha hai, thoda wait karo!");
    return;
  }

  if (!AdController) {
    Telegram.WebApp.showAlert("Ad network load nahi hua. Page refresh karo.");
    return;
  }

  // स्पिन एनिमेशन शुरू (बटन rotate)
  const spinArea = document.getElementById("spinArea");
  spinArea.style.transition = "transform 0.5s ease-out";
  spinArea.style.transform = "rotate(360deg)";
  setTimeout(() => { spinArea.style.transform = "rotate(0deg)"; }, 500);

  Telegram.WebApp.HapticFeedback.impactOccurred("medium");

  AdController.show()
    .then((result) => {
      // Ad पूरा देखा गया (rewarded)
      points++;
      localStorage.setItem(POINT_KEY, points);
      updatePoints();
      showPlusOne(e);
      Telegram.WebApp.HapticFeedback.notificationOccurred("success");
      Telegram.WebApp.showAlert("Badhai ho! +1 Point mila!");
      startCooldown();
    })
    .catch((error) => {
      // Ad skip/error
      Telegram.WebApp.HapticFeedback.notificationOccurred("error");
      Telegram.WebApp.showAlert("Ad nahi dekha ya error aaya. Point nahi mila.");
    });
}

updatePoints();
</script>
</body>
</html>
